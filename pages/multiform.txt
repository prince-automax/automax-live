import { useState } from 'react';
import { Formik, Form, Field } from 'formik';

const MultiStepForm = () => {
    const [data, setData] = useState({
        firstname: '',
        lastName: '',
        email: '',
        password: '',
        location: '',
        city: ''
    });

    const [currentStep, setCurrentStep] = useState(0);

    const makeRequest = (formData) => {
        console.log('Form Submitted', formData);
    };

    const handleNextStep = (newData, final = false) => {
        setData((prev) => ({ ...prev, ...newData }));

        if (final) {
            makeRequest({ ...data, ...newData });
        } else {
            setCurrentStep((prevstate) => prevstate + 1);
        }
    };

    const handlePrevstep = (newData) => {
        setData((prev) => ({ ...prev, ...newData }))
    setCurrentStep((prevstate) => prevstate - 1)
        }
    

        const steps = [
          <StepOne key="step-one" next={handleNextStep} data={data} />,
          <StepTwo key="step-two" next={handleNextStep} prev={handlePrevstep} data={data} />,
          <StepThree key="step-three" prev={handlePrevstep} next={handleNextStep} data={data} />
      ];
      
    return (
        <div>
            {steps[currentStep]}
        </div>
    );
};

// StepOne
const StepOne = (props) => {
    const handleSubmit = (values) => {
        props.next(values);
    };

    return (
        <div className='max-w-2xl h-96 space-y-6 mx-auto bg-slate-100 border p-5 mt-10'>
          <Formik initialValues={props.data} onSubmit={handleSubmit}>
            {() => (
                <Form className='space-y-6'>
                    <p>Vehicle Reg Number</p>
                    <Field name="firstname" className='p-2 border ' />
                    <p>Car Brand</p>
                    <Field name="lastName"  className='p-2 border ' />
                    <div>
                        <button  className="mt-2 w-full inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:w-auto" type="submit">Next</button>
                    </div>
                </Form>
            )}
        </Formik>
        </div>
    );
};

// StepTwo
const StepTwo = (props) => {
    const handleSubmit = (values) => {
        props.next(values);
    };

    return (
      <div className='max-w-2xl mx-auto bg-slate-100 border p-5 mt-10'>
         <Formik initialValues={props.data} onSubmit={handleSubmit}>
            {({values}) => (
                   <Form className='space-y-6'>
                    <p>make</p>
                    <Field name="email"  className='p-2 border '/>
                    <p>model</p>
                    <Field name="password"  className='p-2 border ' />
                 
                    <div className='space-x-5'>
                    <button  className="mt-2 w-full inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:w-auto" type="button" onClick={()=>props.prev(values)}>Back</button>
                        <button  className="mt-2 w-full inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:w-auto" type="submit">Next</button>
                    </div>
                </Form>
            )}
        </Formik>
       </div>
    );
};

// StepThree
const StepThree = (props) => {
    const handleSubmit = (values) => {
        props.next(values, true);
    };

    return (
      <div className='max-w-2xl mx-auto bg-slate-100 border p-5 mt-10'>
          <Formik initialValues={props.data} onSubmit={handleSubmit}>
            {({values}) => (
                  <Form className='space-y-6'>
                    <p>fuel type</p>
                    <Field name="location"  className='p-2 border '/>
                    <p>tranmission type</p>
                    <Field name="city"  className='p-2 border ' />
                    <div className='space-x-5'>
                    <button  className="mt-2 w-full inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:w-auto" type="button" onClick={()=>props.prev(values)}>Back</button>
                        <button  className="mt-2 w-full inline-flex items-center justify-center px-6 py-3 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 sm:w-auto" type="submit">Submit</button>
                    </div>
                </Form>
            )}
        </Formik>
        </div>
    );
};

export default MultiStepForm;
